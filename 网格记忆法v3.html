<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç½‘æ ¼è®°å¿†æ³•ç½‘é¡µ</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background-color: #121212; /* åˆå§‹ä¸ºå¤œé—´æ¨¡å¼èƒŒæ™¯è‰² */
      word-wrap: break-word;
      color: #D3D3D3; /* æµ…ç°è‰²æ–‡å­— */
    }
  
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
  
    .container {
      width: 80%;
      max-width: 800px;
      display: flex;
      flex-direction: column;
      height: 95%;
    }
  
    #inputText {
      height: 40px; /* å›ºå®šé«˜åº¦ï¼Œä¾‹å¦‚3è¡Œ */
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin-bottom: 5px;
      resize: none;
      background-color: #333; /* åˆå§‹ä¸ºå¤œé—´æ¨¡å¼èƒŒæ™¯è‰² */
      color: #D3D3D3; /* æµ…ç°è‰²æ–‡å­— */
    }
  
    #spaceIntervalLabel {
      margin-right: 5px;
      font-size: 14px;
    }

    #spaceInterval {
      width: 50px;
      padding: 5px;
      font-size: 14px;
      margin-bottom: 5px;
      background-color: #333; /* åˆå§‹ä¸ºå¤œé—´æ¨¡å¼èƒŒæ™¯è‰² */
      color: #D3D3D3; /* æµ…ç°è‰²æ–‡å­— */
      border: 1px solid #ccc;
      border-radius: 3px;
    }

    .buttons {
      display: flex;
      justify-content: space-evenly;
      width: 105%;
      margin-bottom: 5px;
    }
  
    button {
      padding: 10px 20px;
      background-color: #4caf4f65; /* åˆå§‹ä¸ºå¤œé—´æ¨¡å¼æŒ‰é’®é¢œè‰² */
      color: rgb(210, 210, 210);
      border: none;
      cursor: pointer;
      font-size: 16px;
      border-radius: 3px;
    }
  
    #outputText {
      flex-grow: 1; /* è‡ªåŠ¨å¡«å……å‰©ä½™ç©ºé—´ */
      width: 100%;
      padding: 10px;
      font-size: 16px;
      word-break: break-all;
      border: 1px solid #ccc;
      resize: none;
      background-color: #333; /* åˆå§‹ä¸ºå¤œé—´æ¨¡å¼èƒŒæ™¯è‰² */
      color: #D3D3D3; /* æµ…ç°è‰²æ–‡å­— */
    }

    #themeToggle {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 10px;
      background-color: rgba(255, 217, 0, 0.8); /* é‡‘è‰² */
      color: black;
      border: none;
      cursor: pointer;
      font-size: 16px;
      border-radius: 50%;
    }

    body.day-mode {
      background-color: #F0EAD6; /* ç™½å¤©æ¨¡å¼èƒŒæ™¯è‰² */
      color: #000000; /* é»‘è‰²æ–‡å­— */
    }

    body.day-mode #inputText,
    body.day-mode #spaceInterval,
    body.day-mode #outputText {
      background-color: #F5F5DC; /* ç™½å¤©æ¨¡å¼èƒŒæ™¯è‰² */
      color: #000000; /* é»‘è‰²æ–‡å­— */
    }

    body.day-mode button {
      background-color: #4CAF50; /* ç™½å¤©æ¨¡å¼æŒ‰é’®é¢œè‰² */
      color: white;
    }
  </style>
</head>

<body>
  <button id="themeToggle" onclick="toggleTheme()">ğŸŒ™</button>
  <div class="container">
    <textarea id="inputText" placeholder="è¾“å…¥æ–‡æœ¬"></textarea>
    <div class="buttons">
      <label id="spaceIntervalLabel" for="spaceInterval">æŒ–ç©º<br>é—´éš”</label>
      <input type="number" id="spaceInterval" value="1" min="1">
      <button onclick="pasteFromClipboard()">ç²˜è´´å‰ªåˆ‡æ¿</button>
      <button onclick="clearInput()">æ¸…ç©ºè¾“å…¥æ¡†</button>
      <button onclick="generateVersion1()">è¾“å‡ºç‰ˆæœ¬ 1</button>
      <button onclick="generateVersion2()">è¾“å‡ºç‰ˆæœ¬ 2</button>
      <button onclick="showOriginal()">æ˜¾ç¤ºåŸæ–‡</button>
    </div>
    <textarea id="outputText" readonly></textarea>
  </div>

  <script>
    function pasteFromClipboard() {
      navigator.clipboard.readText().then(text => {
        document.getElementById('inputText').value = text;
      });
    }

    function clearInput() {
      document.getElementById('inputText').value = '';
      document.getElementById('outputText').value = '';
    }


    function generateVersion1() {
      const input = document.getElementById('inputText').value;
      let output = '';
      let words = input.split(' ');
      let wordIndex = 0;
      const spaceInterval = parseInt(document.getElementById('spaceInterval').value, 10);

      words.forEach(word => {
        if (isChinese(word)) {
          output += processChinese(word, wordIndex) + '';
        } else {
          output += processEnglish(word, wordIndex)  + ' ';
        }
        wordIndex++;
      });

      document.getElementById('outputText').value = output.trim();
    }
    

    function generateVersion2() {
      const input = document.getElementById('inputText').value;
      let output = '';
      let words = input.split(' ');
      const spaceInterval = parseInt(document.getElementById('spaceInterval').value, 10);
      let wordIndex = spaceInterval;      

      words.forEach(word => {
        if (isChinese(word)) {
          output += processChinese(word, wordIndex) + '';
        } else {
          output += processEnglish(word, wordIndex)  + ' ';
        }
        wordIndex++;
      });

      document.getElementById('outputText').value = output.trim();
    }

    function isChinese(str) {
      return /[\u4e00-\u9fa5]/.test(str);
    }

    function isPunctuation(str) {
    return /[\u2000-\u206F\u0020-\u002F\u003A-\u003F\u005B-\u0060\u007B-\u007E]/.test(str);
    } //æ’é™¤æ ‡ç‚¹

    function processChinese(word, wordIndex) {
      let result = '';
      const spaceInterval = parseInt(document.getElementById('spaceInterval').value, 10);
      for (let i = 0; i < word.length; i++) { // éå†ä¸²ä¸²é‡Œçš„æ¯ä¸ªæ±‰å­—
        if (isChinese(word[i])) { // é˜²æ­¢æ±‰å­—å¤¹æ‚è‹±æ–‡ç¬¦å·ï¼ŒåŒä¿é™©
          if ((i + wordIndex) % (spaceInterval*2) >= spaceInterval){//iæ˜¯ä¸€ä¸ªä¸²ä¸²é‡Œçš„æ±‰å­—åºå·ï¼Œwordindexæ˜¯ä¸²ä¸²åºå·ï¼Œæ·»åœ¨ä¸­æ–‡å¤„ç†å‡½æ•°ä¸»è¦ç”¨äºåŒºåˆ†ç‰ˆæœ¬ï¼Œå› ä¸ºè¾“å‡ºç‰ˆæœ¬12çš„åˆå§‹å€¼ä¸åŒ
          // if ((i + wordIndex) % 2 === 0) { //åªèƒ½å¤„ç†æŒ–ç©ºé—´éš”1
            result += 'â˜'; // æ›¿æ¢ä¸ºæ–¹æ¡†
          } else {
            result += word[i];
          }
        } else {
          result += word[i]; // å¤„ç†éæ±‰å­—å­—ç¬¦
        }
      }
      return result;
    }

    /*function processEnglish(word, wordIndex)  {
      if  (wordIndex % 2 === 0) {
        return '_'.repeat(word.length);
      } else {
        return word;
      } 
    }*///ä»£ç ç®€æ´ï¼Œä½†å¤„ç†ä¸äº†æ ‡ç‚¹
    
    function processEnglish(word, wordIndex) {
      let result = '';
      const spaceInterval = parseInt(document.getElementById('spaceInterval').value, 10);
      for (let i = 0; i < word.length; i++) { // éå†ä¸²ä¸²é‡Œçš„æ¯ä¸ªå­—ç¬¦
        if (!isPunctuation(word[i])) { // æ’é™¤æ ‡ç‚¹ï¼Œæ ‡ç‚¹ä¿æŒåŸæ ·
          if ((wordIndex) % (spaceInterval*2) >= spaceInterval){//åŒºåˆ†ç‰ˆæœ¬
          //if (wordIndex % 2 === 0) {//åªèƒ½å¤„ç†æŒ–ç©ºé—´éš”1
            result += '_'; // æ›¿æ¢ä¸ºæ–¹æ¡†
          } else {
            result += word[i];
          }
        } else {
          result += word[i]; // å¤„ç†æ ‡ç‚¹ç¬¦å·ï¼Œä¿æŒåŸæ ·
        }
      }
      return result;
    }
  

    function showOriginal() {
      document.getElementById('outputText').value = document.getElementById('inputText').value;
    }

    function toggleTheme() {
      const body = document.body;
      const themeToggle = document.getElementById('themeToggle');

      if (body.classList.contains('day-mode')) {
        body.classList.remove('day-mode');
        themeToggle.textContent = 'ğŸŒ™'; // æœˆäº®å›¾æ ‡
      } else {
        body.classList.add('day-mode');
        themeToggle.textContent = 'â˜€ï¸'; // å¤ªé˜³å›¾æ ‡
      }
    }

    function initTheme() {
      const currentHour = new Date().getHours();
      const body = document.body;
      const themeToggle = document.getElementById('themeToggle');

      if (currentHour >= 12 && currentHour < 22) {
        // ç™½å¤©æ¨¡å¼
        body.classList.add('day-mode');
        themeToggle.textContent = 'â˜€ï¸'; // å¤ªé˜³å›¾æ ‡
      } else {
        // å¤œé—´æ¨¡å¼
        body.classList.remove('day-mode');
        themeToggle.textContent = 'ğŸŒ™'; // æœˆäº®å›¾æ ‡
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆåè°ƒç”¨åˆå§‹åŒ–å‡½æ•°
    window.onload = initTheme;
  </script>
</body>
</html>